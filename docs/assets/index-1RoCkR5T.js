(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();const W=new URL(window.location.href),M=new URLSearchParams(W.search).get("ip");let l=new WebSocket("ws:/"+M+":9002");const n=document.getElementById("canvas"),O=document.querySelector(".button"),c=(()=>{let t=n.getContext("2d");if(t)return t;throw new Error("Failed to get 2d contex")})();n.width=window.innerWidth*.3;n.height=window.innerWidth*.3;window.addEventListener("resize",()=>{n.width=window.innerWidth*.3,n.height=window.innerWidth*.3});l.addEventListener("message",t=>{let i=t.data.split(",");const s=[];i.forEach((e,o)=>{s.push([Number(e)*100,o])}),s.sort((e,o)=>e[0]-o[0]),s.forEach((e,o)=>{let d=document.getElementById((9-o).toString());d.textContent="nÂ° "+e[1]+": "+e[0].toFixed(2)+"%"})});l.addEventListener("close",t=>{console.log("WebSocket connection closed:",t)});let y=performance.now();function E(){const t=c.canvas.width,r=c.canvas.height;let i=c.getImageData(0,0,t,r).data;if(l.readyState!==l.OPEN)return;let s=new Uint8Array(i.length/4);for(let a=0;a<i.length;a+=4)s[a/4]=i[a+3];const e=Math.floor(t/28),o=new Uint8Array(784);for(let a=0;a<28;a++)for(let u=0;u<28;u++){let v=0;for(let h=0;h<e;h++)for(let w=0;w<e;w++){const P=Math.floor(u*e)+h,D=(Math.floor(a*e)+w)*t+P;v+=s[D]}const S=v/(e*e);o[a*28+u]=Math.min(Math.round(S),255)}let d=o.join(",");l.send(d)}let p=!1,g=0,m=0;const L=t=>{p=!0;const{x:r,y:i}=b(t);g=r,m=i},x=t=>{if(!p)return;const{x:r,y:i}=b(t);c.strokeStyle="#000",c.lineJoin="round",c.lineWidth=n.width/10,c.beginPath(),c.moveTo(g-n.width/20,m-n.width/20),c.lineTo(r-n.width/20,i-n.width/20),c.closePath(),c.stroke(),g=r,m=i,performance.now()-y>200&&(E(),y=performance.now())},f=()=>{p=!1},b=t=>{const r=n.getBoundingClientRect();let i,s;if(t instanceof MouseEvent)i=t.clientX-r.left,s=t.clientY-r.top;else{const e=t.touches[0];i=e.clientX-r.left,s=e.clientY-r.top}return{x:i,y:s}};n.addEventListener("mousedown",t=>{t.button==0&&L(t)});n.addEventListener("mousemove",x);n.addEventListener("mouseup",f);n.addEventListener("mouseout",f);n.addEventListener("touchstart",t=>{t.preventDefault(),L(t)});n.addEventListener("touchmove",t=>{t.preventDefault(),x(t)});n.addEventListener("touchend",f);n.addEventListener("touchcancel",f);O.addEventListener("click",()=>{c.clearRect(0,0,n.width,n.height),E()});
